<html>
<head>
<title>BBAW Digital Knowledge Store: Query Resources</title>
<script type="text/javascript">
<!--
function Browse() {
  var luceneQuery = document.getElementById("luceneQueryId1");
  var schema1checked = document.getElementById("schema1Id").checked;
  var schema2checked = document.getElementById("schema2Id").checked;
  var schema3checked = document.getElementById("schema3Id").checked;
  var luceneSchemaQueryStr = GetLuceneSchemaQuery();
  if (schema1checked && schema2checked && schema3checked)
    luceneSchemaQueryStr =  "*";
  luceneQuery.value = luceneSchemaQueryStr;
}
function GetLuceneSchemaQuery() {
  var schemaFieldValue = "schemaName";
  var schema1Val = document.getElementById("schema1Id").value;
  var schema2Val = document.getElementById("schema2Id").value;
  var schema3Val = document.getElementById("schema3Id").value;
  var schema1checked = document.getElementById("schema1Id").checked;
  var schema2checked = document.getElementById("schema2Id").checked;
  var schema3checked = document.getElementById("schema3Id").checked;
  var luceneQueryStr = "";
  if (schema1checked && schema2checked && schema3checked)
    luceneQueryStr = "*:*";
  if (!schema1checked && schema2checked && schema3checked)
    luceneQueryStr = "*:*" + " -" + schemaFieldValue + ":" + schema1Val;
  if (schema1checked && !schema2checked && schema3checked)
    luceneQueryStr = "*:*" + " -" + schemaFieldValue + ":" + schema2Val;
  if (schema1checked && schema2checked && !schema3checked)
    luceneQueryStr = "*:*" + " +" + schemaFieldValue + ":(" + schema1Val + " " + schema2Val + ")";
  if (!schema1checked && schema2checked && !schema3checked)
    luceneQueryStr = "*:*" + " +" + schemaFieldValue + ":" + schema2Val;
  if (schema1checked && !schema2checked && !schema3checked)
    luceneQueryStr = "*:*" + " +" + schemaFieldValue + ":" + schema1Val;
  if (!schema1checked && !schema2checked && schema3checked)
    luceneQueryStr = "*:*" + " -" + schemaFieldValue + ":(" + schema1Val + " " + schema2Val + ")";
  if (!schema1checked && !schema2checked && !schema3checked)
    luceneQueryStr = "-*:*";
  return luceneQueryStr;
}
function GetLuceneBoolOp(relOp) {
  if (relOp == "mustContain")
    return "+";
  else if (relOp == "mustNotContain")
    return "-";
  else 
    return "";
}
function AttributeQuery() {
  var luceneQuery = document.getElementById("luceneQueryId2");
  var sortBy = document.getElementById("sortById2");
  var field1Val = document.getElementById("field1Id").value;
  var field1QueryVal = document.getElementById("field1QueryId").value;
  var relOp1Value = document.getElementById("relOp1Id").value;
  var relOp1ValueLucene = GetLuceneBoolOp(relOp1Value);
  var field2Val = document.getElementById("field2Id").value;
  var field2QueryVal = document.getElementById("field2QueryId").value;
  var relOp2Value = document.getElementById("relOp2Id").value;
  var relOp2ValueLucene = GetLuceneBoolOp(relOp2Value);
  var luceneQueryStr = "";
  if (field1QueryVal != "")
	luceneQueryStr = relOp1ValueLucene + field1Val + ":" + field1QueryVal;
  if (field2QueryVal != "")
    luceneQueryStr = luceneQueryStr + " " + relOp2ValueLucene + field2Val + ":" + field2QueryVal;
  var schemaQueryStr = GetLuceneSchemaQuery();
  var schema1checked = document.getElementById("schema1Id").checked;
  var schema2checked = document.getElementById("schema2Id").checked;
  var schema3checked = document.getElementById("schema3Id").checked;
  if (schema1checked && schema2checked && schema3checked && !(relOp1ValueLucene == "-" || relOp2ValueLucene == "-"))
    schemaQueryStr =  "";
  luceneQueryStr = luceneQueryStr + " " + schemaQueryStr;
  luceneQuery.value = luceneQueryStr;
  sortBy.value = "author";
}
function FulltextQuery() {
  var luceneQuery = document.getElementById("luceneQueryId3");
  var translateElem = document.getElementById("translateId3");
  translateElem.value = "false";
  var isTranslateQuery = document.getElementById("isTranslateQueryId").checked;
  if (isTranslateQuery)
    translateElem.value = "true";
  var fulltextQueryFieldValue = "tokenOrig";
  var isMorphQuery = document.getElementById("isMorphQueryId").checked;
  if (isMorphQuery)
    fulltextQueryFieldValue = "tokenMorph";
  var fulltextQueryVal = document.getElementById("fulltextQueryId").value;
  var luceneQueryStr = "+" + fulltextQueryFieldValue + ":(" + fulltextQueryVal + ")";
  changeIsMorph();
  var schemaQueryStr = GetLuceneSchemaQuery();
  var schema1checked = document.getElementById("schema1Id").checked;
  var schema2checked = document.getElementById("schema2Id").checked;
  var schema3checked = document.getElementById("schema3Id").checked;
  if (schema1checked && schema2checked && schema3checked)
    schemaQueryStr =  "";
  luceneQueryStr = luceneQueryStr + " " + schemaQueryStr;
  luceneQuery.value = luceneQueryStr;
}
function changeIsMorph() {
  var isMorphQuery = document.getElementById("isMorphQueryId").checked;
  var language = document.getElementById("languageId3");
  if (isMorphQuery) {
    var languageValue = document.getElementById("languageId").value;
    if (languageValue == "none") {
      if (language != null)	
        language.parentNode.removeChild(language);	
    } else if (language == null) {
      var queryDocumentsForm = document.getElementById("queryDocumentsId");
      var languageElement = document.createElement("input");
      languageElement.setAttribute("type", "hidden");
      languageElement.setAttribute("name", "language");
      languageElement.setAttribute("id", "languageId3");
      languageElement.value = languageValue;
      queryDocumentsForm.appendChild(languageElement);
    } else if (language != null) {
      language.value = languageValue;
    }
  } else {
    if (language != null)	
      language.parentNode.removeChild(language);
  }
}
function checkCR(event) {
  var keyCode = event.keyCode
  if (keyCode == 13)
    return false;
}

-->
</script>
</head>
<body>
  <table style="height:60px">
    <colgroup>
      <col width="90%"/>
      <col width="10%"/>
    </colgroup>
    <tr>
    <td align="left" valign="top" style="font-weight:bold;font-size:30px">
      Query resources <a href="info.html" target="_blank"><img src="../images/info.png" width="18" height="18" border="0" alt="Info Query Resources"/></a>
    </td>
    <td align="right" valign="top"></td>
    </tr>
  </table>
  <hr/>
  <table>
    <tr>
    <td valign="top" height="50px">
      <table>
      <tr>
        <td valign="top"><b>Resource formats:</b></td>
        <td valign="top"><span style="margin-left:20px;">TEI</span><br/></td>
        <td valign="top">
          <input type="checkbox" name="schema1" id="schema1Id" value="TEI" checked="checked" style="margin-left:1px;"/>
        </td>
        <td valign="top"><span style="margin-left:20px;">HTML</span><br/></td>
        <td valign="top">
          <input type="checkbox" name="schema2" id="schema2Id" value="html" checked="checked" style="margin-left:1px;"/>
        </td>
        <td valign="top"><span style="margin-left:20px;">Other</span><br/></td>
        <td valign="top">
          <input type="checkbox" name="schema3" id="schema3Id" value="diverse" checked="checked" style="margin-left:1px;"/>
        </td>
        <td valign="top">
          <form name="queryDocuments" action="/wspCmsWebApp/query/QueryDocuments" method="get" accept-charset="utf-8">
          <input type="hidden" name="query" id="luceneQueryId1"/>
          <input type="hidden" name="sortBy" id="sortById1" value="author"/>
          <button type="submit" onclick="Browse()" style="margin-left:20px;"><span>Browse</span></button>
         </form>
        </td>
      </tr>
      <tr>
      </tr>
      </table> 
    </td>
    </tr>

    <tr>
    <td valign="top" height="70px">
      <table>
      <tr>
      <td valign="top">
      <select name="field1" id="field1Id">
      <option value ="docId">Id</option>
      <option value ="collectionNames">Project</option>
      <option value ="author" selected>Author</option>
      <option value ="title">Title</option>
      <option value ="publisher">Publisher</option>
      <option value ="date">Publication date</option>
      <option value ="language">Language</option>
      <option value ="description">Description</option>
      <option value ="subject">Subject</option>
      <option value ="swd">SWD</option>
      <option value ="ddc">DDC</option>
      <option value ="persons">Persons</option>
      <option value ="places">Places</option>
      <option value ="type">Mime type</option>
      <option value ="schemaName">Schema name</option>
      </select>          
      </td>
      <td valign="top">
      <select name="relOp1" id="relOp1Id">
      <option value ="mustContain" selected>must contain</option>
      <option value ="mayContain">may contain</option>
      <option value ="mustNotContain">does not contain</option>
      </select>          
      </td>
      <td valign="top">
      <input type="text" size="40" name="field1Query" id="field1QueryId" onkeypress="return checkCR(event)"/>
      </td>
      <td valign="top">
      <form name="queryDocuments" action="/wspCmsWebApp/query/QueryDocuments" method="get" accept-charset="utf-8">
        <input type="hidden" name="query" id="luceneQueryId2"/>
        <input type="hidden" name="sortBy" id="sortById2"/>
        <button type="submit" onclick="AttributeQuery()">Query</button>
      </form>
      </td>
      </tr>

      <tr>
      <td valign="top">
      <select name="field2" id="field2Id">
      <option value ="docId">Id</option>
      <option value ="collectionNames">Project</option>
      <option value ="author">Author</option>
      <option value ="title" selected>Title</option>
      <option value ="publisher">Publisher</option>
      <option value ="date">Publication date</option>
      <option value ="language">Language</option>
      <option value ="description">Description</option>
      <option value ="subject">Subject</option>
      <option value ="swd">SWD</option>
      <option value ="ddc">DDC</option>
      <option value ="persons">Persons</option>
      <option value ="places">Places</option> 
      <option value ="type">Mime type</option>
      <option value ="schemaName">Schema name</option>
      </select>          
      </td>
      <td valign="top">
      <select name="relOp2" id="relOp2Id">
      <option value ="mustContain" selected>must contain</option>
      <option value ="mayContain">may contain</option>
      <option value ="mustNotContain">does not contain</option>
      </select>          
      </td>
      <td valign="top">
      <input type="text" size="40" name="field2Query" id="field2QueryId" value="" onkeypress="return checkCR(event)"/>
      </td>
      </tr>
      </table>
    </td>
    <td/>
    </tr>
    
    <tr>
    <td height="60px">
      <table style="vertical-align:bottom">
        <tr>
        <td>
        Resource contains <input type="text" size="40" name="fulltextQuery" id="fulltextQueryId" onkeypress="return checkCR(event)"/>
        </td>
        <td>
          <form id="queryDocumentsId" name="queryDocuments" action="/wspCmsWebApp/query/QueryDocuments" method="get" accept-charset="utf-8">
            <input type="hidden" name="query" id="luceneQueryId3"/>
            <input type="hidden" name="language" id="languageId3"/>
            <input type="hidden" name="translate" id="translateId3"/>
            <button type="submit" onclick="FulltextQuery()">Query</button>
          </form>
        </td>
        </tr>
      </table>
      <table style="vertical-align:top">
        <tr>
          <td><span style="margin-left:30px;">morphological</span></td>
          <td><span style="margin-left:1px;"></span><input type="checkbox" name="isMorphQuery" id="isMorphQueryId" value="isMorphQuery" onchange="ChangeIsMorph()"/></td>
          <td><span style="margin-left:3px;">language: </span></td>
          <td style="margin-left:3px;">
            <span style="margin-left:1px;"></span>
            <select name="language" id="languageId">
              <option value ="none" selected>None</option>
              <option value ="ara">Arabic</option>
              <option value ="zho">Chinese</option>
              <option value ="nld">Dutch</option>
              <option value ="eng">English</option>
              <option value ="fra">French</option>
              <option value ="deu">German</option>
              <option value ="grc">Greek</option>
              <option value ="ita">Italian</option>
              <option value ="lat">Latin</option>
            </select>
          </td>
          <td><span style="margin-left:10px;">translate</span><br/></td>
          <td><span style="margin-left:1px;"></span><input type="checkbox" name="isTranslateQuery" id="isTranslateQueryId" value="translate"/></td>
        </tr>
      </table>
    </td>
    </tr>
  </table> 
  <hr/>
  <p/>
  Release 0.7, August, 2013
</body>
</html>