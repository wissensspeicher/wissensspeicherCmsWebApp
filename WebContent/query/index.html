<html>
<head>
<title>BBAW Digital Knowledge Store: Query Documents</title>
<script type="text/javascript">
<!--
function Browse() {
  var luceneQuery = document.getElementById("luceneQuery");
  var luceneSchemaQueryStr = GetLuceneSchemaQuery();
  luceneQuery.value = luceneSchemaQueryStr;
}
function GetLuceneSchemaQuery() {
  var schemaFieldValue = "schemaName";
  var schema1Val = document.queryDocuments.schema1.value;
  var schema2Val = document.queryDocuments.schema2.value;
  var schema3Val = document.queryDocuments.schema3.value;
  var luceneQueryStr = "+" + schemaFieldValue + ":" + "(";
  if (document.queryDocuments.schema1.checked)
    luceneQueryStr = luceneQueryStr + schema1Val;
  if (document.queryDocuments.schema2.checked)
    luceneQueryStr = luceneQueryStr + " " + schema2Val;
  if (document.queryDocuments.schema3.checked)
	luceneQueryStr = luceneQueryStr + " " + schema3Val;
  luceneQueryStr = luceneQueryStr + ")";
  return luceneQueryStr;
}
function GetLuceneBoolOp(relOp) {
  if (relOp == "mustContain")
    return "+";
  else if (relOp == "mustNotContain")
    return "-";
  else 
    return "";
}
function AttributeQuery() {
  var luceneQuery = document.getElementById("luceneQuery");
  var field1Val = document.queryDocuments.field1.value;
  var field1QueryVal = document.queryDocuments.field1Query.value;
  var relOp1Value = document.queryDocuments.relOp1.value;
  var relOp1ValueLucene = GetLuceneBoolOp(relOp1Value);
  var field2Val = document.queryDocuments.field2.value;
  var field2QueryVal = document.queryDocuments.field2Query.value;
  var relOp2Value = document.queryDocuments.relOp2.value;
  var relOp2ValueLucene = GetLuceneBoolOp(relOp2Value);
  var luceneQueryStr = relOp1ValueLucene + field1Val + ":";
  luceneQueryStr = luceneQueryStr + field1QueryVal;
  if (field2QueryVal != "")
    luceneQueryStr = luceneQueryStr + " " + relOp2ValueLucene + field2Val + ":" + field2QueryVal;
  var schemaQueryStr = GetLuceneSchemaQuery();
  luceneQueryStr = luceneQueryStr + " " + schemaQueryStr;
  luceneQuery.value = luceneQueryStr;
}
function FulltextQuery() {
  var luceneQuery = document.getElementById("luceneQuery");
  var translateElem = document.getElementById("translateId");
  translateElem.value = "false";
  var isTranslateQuery = document.queryDocuments.isTranslateQuery.checked;
  if (isTranslateQuery)
    translateElem.value = "true";
  var fulltextQueryFieldValue = "tokenOrig";
  var isMorphQuery = document.queryDocuments.isMorphQuery.checked;
  if (isMorphQuery)
	fulltextQueryFieldValue = "tokenMorph";
  var fulltextQueryVal = document.queryDocuments.fulltextQuery.value;
  var schemaQueryStr = GetLuceneSchemaQuery();
  var luceneQueryStr = "+" + fulltextQueryFieldValue + ":" + fulltextQueryVal;
  var language = document.queryDocuments.language.value;
  if (isMorphQuery && language != "none")
    luceneQueryStr = luceneQueryStr + " " + "+language:" + language;    
  luceneQueryStr = luceneQueryStr + " " + schemaQueryStr;
  luceneQuery.value = luceneQueryStr;
}
function checkCR(event) {
  var keyCode = event.keyCode
  if (keyCode == 13)
    return false;
}

-->
</script>
</head>
<body>
  <form name="queryDocuments" action="/wspCmsWebApp/query/QueryDocuments" method="post">
  <input type="hidden" name="query" id="luceneQuery"/>
  <input type="hidden" name="translate" id="translateId"/>
  <table height="60px">
    <colgroup>
      <col width="90%"/>
      <col width="10%"/>
    </colgroup>
    <tr>
    <td align="left" valign="top">
      <text style="font-weight:bold;font-size:30px">Query documents <a href="info.html#queryDocuments" target="_blank"><img src="../images/info.png" valign="bottom" width="18" height="18" border="0" alt="Info Query Documents"/></a></text>
    </td>
    <td align="left" valign="top">
      Release 0.5, July, 2012
    </td>
    </tr>
  </table>
  <hr/>
  <table>
    <tr>
    <td valign="top" height="50px">
      <table>
      <tr>
        <td valign="top"><b>Document formats:</b></td>
        <td valign="top">
          <text style="margin-left:20px;">TEI</text><br/>
        </td>
        <td valign="top">
          <text style="margin-left:1px;"></text><input type="checkbox" name="schema1" value="TEI" checked="checked"/>
        </td>
        <td valign="top">
          <text style="margin-left:20px;">HTML</text><br/>
        </td>
        <td valign="top">
          <text style="margin-left:1px;"></text><input type="checkbox" name="schema2" value="html" checked="checked"/>
        </td>
        <td valign="top">
          <text style="margin-left:20px;">Diverse</text><br/>
        </td>
        <td valign="top">
          <text style="margin-left:1px;"></text><input type="checkbox" name="schema3" value="diverse" checked="checked"/>
        </td>
        <td valign="top"><text style="margin-left:40px;"></text><button type="submit" name="browse" onclick="Browse()">Browse</button></td>
        <td valign="top"><a href="../query/info.html#docBases" target="_blank"><img src="../images/info.png" valign="bottom" width="15" height="15" border="0" alt="Info Document bases"/></a></td>
      </tr>
      <tr>
      </tr>
      </table> 
    </td>
    </tr>

    <tr>
    <td valign="top" height="70px">
      <table>
      <tr>
      <td>
      <select name="field1">
      <option value ="author" selected="true">Author</option>
      <option value ="title">Title</option>
      <option value ="place">Place</option>
      <option value ="date">Year</option>
      <option value ="language">Language</option>
      <option value ="identifier">Identifier</option>
      </select>          
      </td>
      <td>
      <select name="relOp1">
      <option value ="mustContain" selected="true">must contain</option>
      <option value ="mayContain">may contain</option>
      <option value ="mustNotContain">must not contain</option>
      <option value ="equal"> = </option>
      </select>          
      </td>
      <td>
      <input type="text" size="40" name="field1Query" onkeypress="return checkCR(event)"/>
      <button type="submit" name="field1QuerySubmit" onclick="AttributeQuery()">Query</button>
      <a href="info.html#metadataQuery" target="_blank"><img src="../images/info.png" valign="bottom" width="15" height="15" border="0" alt="Info Metadata search"/></a>
      </td>
      </tr>

      <tr>
      <td>
      <select name="field2">
      <option value ="author">Author</option>
      <option value ="title" selected="true">Title</option>
      <option value ="place">Place</option>
      <option value ="date">Year</option>
      <option value ="language">Language</option>
      <option value ="identifier">Identifier</option>
      </select>          
      </td>
      <td>
      <select name="relOp2">
      <option value ="mustContain" selected="true">must contain</option>
      <option value ="mayContain">may contain</option>
      <option value ="mustNotContain">must not contain</option>
      <option value ="equal"> = </option>
      </select>          
      </td>
      <td>
      <input type="text" size="40" name="field2Query" value="" onkeypress="return checkCR(event)"/>
      </td>
      </tr>
      </table>
    </td>
    <td/>
    </tr>
    
    <tr>
    <td valign="top" height="60px">
      <table>
        <tr>
        <td>
        Document contains <input type="text" size="40" name="fulltextQuery" onkeypress="return checkCR(event)"/>
        <button type="submit" name="fulltextQuerySubmit" onclick="FulltextQuery()">Query</button>
        </td>
        <td valign="bottom">
        <a href="info.html#fulltextMorph" target="_blank"><img src="../images/info.png" width="15" height="15" border="0" alt="Info fulltext query"/></a>
        </td>
        </tr>
      </table>
      <table>
        <tr>
          <td valign="top">
            <text style="margin-left:30px;">morphological</text>
          </td>
          <td valign="top">
            <text style="margin-left:1px;"></text><input type="checkbox" name="isMorphQuery" value="isMorphQuery"/>
          </td>
          <td valign="top">
            <text style="margin-left:3px;">language: </text>
          </td>
          <td valign="top" style="margin-left:3px;">
          <text style="margin-left:1px;"></text>
          <select name="language">
          <option value ="none" selected="true">None</option>
          <option value ="ara">Arabic</option>
          <option value ="zho">Chinese</option>
          <option value ="nld">Dutch</option>
          <option value ="eng">English</option>
          <option value ="fra">French</option>
          <option value ="deu">German</option>
          <option value ="grc">Greek</option>
          <option value ="ita">Italian</option>
          <option value ="lat">Latin</option>
          </select>
          </td>
          <td valign="top">
            <text style="margin-left:10px;">translate</text><br/>
          </td>
          <td valign="top">
            <text style="margin-left:1px;"></text><input type="checkbox" name="isTranslateQuery" value="translate"/>
          </td>
        </tr>
      </table>
    </td>
    </tr>

  </table> 
  <hr/>
  <p/>
  See the <a href="../cms-services.html">CMS Services Page</a>
  <br/>Last software update: July, 2012
</form>
</body>
</html>